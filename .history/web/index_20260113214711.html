<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Local Glossary â€” editable</title>
  <link rel="stylesheet" href="/web/styles.css">
</head>
<body>
  <main>
    <h1>Local Glossary</h1>
    <p>Search and manage your own glossary entries (terms or abbreviations).</p>

    <nav class="mainMenu" role="navigation" aria-label="Main menu">
      <button id="menuGlossary" class="active">Glossary</button>
      <button id="menuDiagrams">Diagrams</button>
      <button id="menuEquations">Equations</button>
    </nav>

    <div id="glossaryApp">
      <div class="search">
        <input id="q" type="search" placeholder="Search (term, definition, abbreviation)" autofocus />
        <div style="display:flex;gap:8px;align-items:center">
          <button id="viewDb" title="View full DB">View DB</button>
          <button id="showAdd">+ Add</button>
        </div>
      </div>

      <section id="editor" class="editor hidden" aria-hidden="true">
      <h2 id="editorTitle">Add a new entry</h2>
      <form id="addForm">
        <div class="row">
          <label>Term
            <input id="fieldTerm" required />
          </label>
        </div>
        <label>Abbreviation (optional)
          <input id="fieldAbbreviation" placeholder="e.g. BOE" />
        </label>
        <label>Definition / Signification
          <textarea id="fieldDefinition" rows="4" required></textarea>
        </label>
        <input type="hidden" id="fieldId" />
        <div class="formActions">
          <button id="saveBtn" type="submit">Save</button>
          <button id="cancelBtn" type="button">Cancel</button>
        </div>
      </form>
    </section>

      <div id="results"></div>
    </div>

    <!-- Diagrams app view (inline, not modal) -->
    <section id="diagramsApp" class="hidden" aria-hidden="true">
      <h2>Diagrams</h2>
      <p>Upload and browse your schematics and diagrams.</p>
      <form id="uploadFormInline" style="display:flex;gap:8px;align-items:center;margin-bottom:12px">
        <input id="imgTitleInline" placeholder="Title for diagram" style="flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
        <input id="imgFileInline" type="file" accept="image/*,.pdf" />
        <button id="uploadBtnInline" type="button">Upload</button>
      </form>
      <div id="diagramsGallery" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px"></div>
    </section>
  </main>

  <!-- Modal for item detail -->
  <div id="modal" class="modal hidden" aria-hidden="true">
    <div class="modal__overlay" id="modalOverlay"></div>
    <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <header class="modal__header">
        <h2 id="modalTitle">Title</h2>
        <div class="modal__meta" id="modalMeta"></div>
      </header>
      <div class="modal__body" id="modalBody"></div>
      <footer class="modal__footer">
        <button id="copyBtn">Copy definition</button>
        <button id="closeBtn">Close</button>
      </footer>
    </div>
  </div>

  <!-- Modal for DB viewer -->
  <div id="dbModal" class="modal hidden" aria-hidden="true">
    <div class="modal__overlay" id="dbModalOverlay"></div>
    <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="dbModalTitle">
      <header class="modal__header">
        <h2 id="dbModalTitle">Glossary Database</h2>
        <div class="modal__meta" id="dbModalMeta"></div>
      </header>
      <div class="modal__body" id="dbModalBody">
        <div class="dbControls" style="display:flex;gap:8px;align-items:center;margin-bottom:10px;flex-wrap:wrap">
          <input id="dbSearch" placeholder="Filter term or definition" style="flex:1;min-width:200px;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
          <label style="white-space:nowrap;color:var(--muted)">Sort:
            <select id="dbSort" style="margin-left:6px;padding:6px;border-radius:6px;background:transparent;color:inherit;border:1px solid rgba(255,255,255,0.04)">
              <option value="recent">Most Recent</option>
              <option value="oldest">Oldest First</option>
              <option value="alpha-asc">A-Z (Term)</option>
              <option value="alpha-desc">Z-A (Term)</option>
            </select>
          </label>
          <label style="white-space:nowrap;color:var(--muted)">Rows:
            <select id="dbRows" style="margin-left:6px;padding:6px;border-radius:6px;background:transparent;color:inherit;border:1px solid rgba(255,255,255,0.04)">
              <option value="5">5</option>
              <option value="10" selected>10</option>
              <option value="25">25</option>
            </select>
          </label>
        </div>
        <div id="dbTableContainer" style="max-height:60vh;overflow:auto"></div>
      </div>
      <footer class="modal__footer">
        <button id="downloadDb">Download JSON</button>
        <button id="closeDb">Close</button>
      </footer>
    </div>
  </div>

  <!-- Modal for Diagrams (upload and gallery) -->
  <div id="diagModal" class="modal hidden" aria-hidden="true">
    <div class="modal__overlay" id="diagModalOverlay"></div>
    <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="diagModalTitle">
      <header class="modal__header">
        <h2 id="diagModalTitle">Diagrams</h2>
        <div class="modal__meta" id="diagModalMeta"></div>
      </header>
      <div class="modal__body" id="diagModalBody">
        <form id="uploadForm" style="display:flex;gap:8px;align-items:center;margin-bottom:12px">
          <input id="imgTitle" placeholder="Title for diagram" style="flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
          <input id="imgFile" type="file" accept="image/*,.pdf" />
          <button id="uploadBtn" type="button">Upload</button>
        </form>
        <div id="gallery" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px"></div>
      </div>
      <footer class="modal__footer">
        <button id="closeDiag">Close</button>
      </footer>
    </div>
  </div>

  <!-- Fuse.js for fuzzy search (client-side) -->
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
  <script src="/web/app.js"></script>
</body>
</html>

